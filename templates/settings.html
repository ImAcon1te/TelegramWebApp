{% extends 'base.html' %}
{% block title %}
    Налаштування
{% endblock %}

{% block content %}
<div class="top-nav">
  <a href="{{ url_for('incoming_notifications') }}" class="filter-button"><img src="../static/images/notification_button.png"></a>

  {% if role == 'purchase_offers' %}
    <button id="openRolesModal" class="nav-button">Продавець</button>
  {% elif role == 'sale_offers' %}
    <button id="openRolesModal" class="nav-button">Покупець</button>
  {% elif role == 'rental_offers' %}
    <button id="openRolesModal" class="nav-button">Орендатор</button>
  {% endif %}

  <a href="#" class="filter-button"><img src="../static/images/profile_button.png"></a>
</div>




<div class="settings-page">

    <!-- Заголовок / шапка страницы -->
    <header class="settings-header">
      <h2 class="settings-title">Налаштування</h2>
    </header>

    <!-- Форма настроек -->
    <form class="settings-form" method="POST" action="{{ url_for('settings') }}">

      <!-- Имя -->
      <div class="form-group">
        <label for="first_name" class="form-label">Ім’я</label>
        <input
          type="text"
          class="form-control"
          name="first_name"
          id="first_name"
          value="{{ user.first_name }}"
          placeholder="Введіть..."
        >
      </div>

      <!-- Фамилия -->
      <div class="form-group">
        <label for="last_name" class="form-label">Прізвище</label>
        <input
          type="text"
          class="form-control"
          name="last_name"
          id="last_name"
          value="{{ user.last_name }}"
          placeholder="Введіть..."
        >
      </div>

      <!-- Номер телефона -->
      <div class="form-group">
        <label for="phone" class="form-label">Номер телефону</label>
        <input
          type="text"
          class="form-control"
          name="phone"
          id="phone"
          value="{{ user.phone }}"
          placeholder="Введіть..."
        >
      </div>

      <!-- Область -->
      <div class="form-group">
        <label for="region_id" class="form-label">Область</label>
        <select
          name="region_id"
          id="region_id"
          class="form-control"
        >
          {% for region in regions %}
            <option
              value="{{ region.id }}"
              {% if user.region_id == region.id %}selected{% endif %}
            >
              {{ region.oblast }} - {{ region.district }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Роли -->
      <div class="role-group">
        <div class="role-option">
          <input
            type="checkbox"
            class="form-checkbox"
            name="is_sale"
            id="is_sale"
            {% if user.is_sale %}checked{% endif %}
          >
          <label for="is_sale">Покупець</label>
        </div>

        <div class="role-option">
          <input
            type="checkbox"
            class="form-checkbox"
            name="is_purchase"
            id="is_purchase"
            {% if user.is_purchase %}checked{% endif %}
          >
          <label for="is_purchase">Продавець</label>
        </div>

        <div class="role-option">
          <input
            type="checkbox"
            class="form-checkbox"
            name="is_rental"
            id="is_rental"
            {% if user.is_rental %}checked{% endif %}
          >
          <label for="is_rental">Орендатор</label>
        </div>
        <p class="role-label">Оберіть свою роль</p>
      </div>

      <!-- Кнопка сохранения -->
      <button type="submit" class="btn btn-primary save-btn">
        Зберегти налаштування
      </button>
    </form>
  </div>

<div id="rolesModal" class="modal-overlay" style="display: none;">
  <div class="modal-content">
    <!-- Кнопка закрытия окна -->
    <button
      type="button"
      id="closeRolesModal"
      class="modal-close"
      aria-label="Close"
    >
      &times;
    </button>

    <!-- Заголовок -->
    <h2 class="modal-title">Зміна ролі</h2>
    <!-- Краткая подсказка/описание (необязательно) -->
    <p class="modal-description">Ви можете замінити свою роль</p>

    <!-- Форма выбора роли -->
    <form id="rolesForm">
      {% if user.is_sale %}
      <div class="role-item">
        <label for="role_sale" class="role-label">
          <input
            type="radio"
            id="role_sale"
            name="role"
            value="sale"
            {% if role=='sale_offers' %}checked{% endif %}
          />
          <span class="role-text">Покупець</span>
        </label>
        <div class="role-notification">
          <!-- Можно подключить иконку колокольчика через FontAwesome или другой набор иконок -->
          <i class="fas fa-bell"></i>
          <span class="notif-badge">3</span>
        </div>
      </div>
      {% endif %}
      {% if user.is_purchase %}
      <div class="role-item">
        <label for="role_purchase" class="role-label">
          <input
            type="radio"
            id="role_purchase"
            name="role"
            value="purchase"
            {% if role=='purchase_offers' %}checked{% endif %}
          />
          <span class="role-text">Продавець</span>
        </label>
        <div class="role-notification">
          <i class="fas fa-bell"></i>
          <span class="notif-badge">3</span>
        </div>
      </div>
      {% endif %}
      {% if user.is_rental %}
      <div class="role-item">
        <label for="role_rental" class="role-label">
          <input
            type="radio"
            id="role_rental"
            name="role"
            value="rental"
            {% if role=='rental_offers' %}checked{% endif %}
          />
          <span class="role-text">Орендатор</span>
        </label>
        <div class="role-notification">
          <i class="fas fa-bell"></i>
          <span class="notif-badge">3</span>
        </div>
      </div>
      {% endif %}
    </form>


    <div class="modal-buttons">
      <button type="button" id="saveRoles" class="modal-btn save-btn ">
        Зберегти
      </button>
    </div>
  </div>
</div>
<script src="{{ url_for('static', filename='update_roles.js') }}"></script>
{% endblock %}